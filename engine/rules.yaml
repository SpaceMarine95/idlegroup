vectors:
  web_lfi:
    sids: [100001, 100002]
    window_sec: 10
    thresholds:
      - count: 1
        actions:
          - type: FEATURE
            params: { flag: {style: alt}, ttl_sec: 1800 }
          - type: SPAWN
            params: { template: dvwa_b }
      - count: 3
        actions:
          - type: ASSIGN
            params: { backend: dvwa_b_up, ttl_sec: 7200 }

  web_sqli:
    sids: [100003]
    window_sec: 30
    thresholds:
      - count: 3
        actions:
          - type: SPAWN
            params: { template: dvwa_b }
          - type: ASSIGN
            params: { backend: dvwa_b_up, ttl_sec: 7200 }

  ssh_syn_burst:
    sids: [100100]
    window_sec: 60
    cooldown_sec: 20
    thresholds:
      - count: 1
        actions:
          - type: SSH_ROTATE
            params: { persona: A }
          - type: RATELIMIT
            params: { cidr_from_src: "/32", pps: 60 }
      - count: 50
        actions:
          - type: SHUN
            params: { ttl_sec: 7200 }   # optional but nice for scanners

  ssh_bruteforce:
    source: cowrie                    # <— if your engine supports this; otherwise omit
    eventid: cowrie.login.failed      # <— filter key for Cowrie stream
    key: src_ip                       # <— aggregate key (field present in your sample)
    window_sec: 120
    cooldown_sec: 120                 # don't re-fire immediately for the same IP
    thresholds:
      - count: 6
        actions:
          - type: TAG
            params: { labels: [ssh, bruteforce] }
          - type: SHUN
            params: { ttl_sec: 900 } # 15m; change to taste